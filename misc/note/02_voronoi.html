<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒœãƒ­ãƒã‚¤å›³ - è‡ªç„¶ç•Œã®é ˜åŸŸåˆ†å‰²</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: 'Hiragino Sans', 'Meiryo', sans-serif;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .description {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .controls {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .control-group {
            margin-bottom: 15px;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 10px;
        }
        button:hover {
            background-color: #0056b3;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }
        .value-display {
            display: inline-block;
            margin-left: 10px;
            color: #007bff;
            font-weight: bold;
        }
        #canvas-container {
            text-align: center;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .info {
            margin-top: 10px;
            padding: 10px;
            background-color: #e7f3ff;
            border-left: 4px solid #007bff;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¦’ ãƒœãƒ­ãƒã‚¤å›³ - è‡ªç„¶ç•Œã®é ˜åŸŸåˆ†å‰²</h1>
        
        <div class="description">
            <h2>æœ€ã‚‚è¿‘ã„ç‚¹ã§åˆ†ã‘ã‚‹ä¸æ€è­°ãªãƒ‘ã‚¿ãƒ¼ãƒ³</h2>
            <p>
                ãƒœãƒ­ãƒã‚¤å›³ã¯ã€å¹³é¢ä¸Šã«ã„ãã¤ã‹ã®ç‚¹ãŒã‚ã‚‹ã¨ãã€ã€Œã©ã®ç‚¹ã«æœ€ã‚‚è¿‘ã„ã‹ã€ã§é ˜åŸŸã‚’åˆ†å‰²ã—ãŸå›³å½¢ã§ã™ã€‚
                è‡ªç„¶ç•Œã§ã¯ã€<strong>ã‚­ãƒªãƒ³ã®æ¨¡æ§˜</strong>ã€<strong>ç´°èƒã®å½¢</strong>ã€<strong>èœ‚ã®å·£</strong>ã€
                <strong>ãƒˆãƒ³ãƒœã®ç¾½</strong>ãªã©ã€æ§˜ã€…ãªå ´æ‰€ã§ã“ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒè¦‹ã‚‰ã‚Œã¾ã™ã€‚
            </p>
            <p>
                ã‚­ãƒªãƒ³ã®æ¨¡æ§˜ã¯ã€èƒå…ã®ã¨ãã«æ•£ã‚‰ã°ã£ãŸãƒ¡ãƒ©ãƒ‹ãƒ³åˆ†æ³Œç´°èƒãŒã€å‡ä¸€ãªé€Ÿåº¦ã§æˆé•·ã™ã‚‹ã“ã¨ã§
                è‡ªç„¶ã«ãƒœãƒ­ãƒã‚¤å›³ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ãªã‚Šã¾ã™ã€‚ã“ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ã€é™ã‚‰ã‚ŒãŸç©ºé–“ã‚’åŠ¹ç‡çš„ã«ä½¿ã†ã®ã«
                æœ€é©ãªå½¢ãªã®ã§ã™ã€‚
            </p>
        </div>

        <div class="controls">
            <h3>ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã«æ“ä½œã—ã‚ˆã†</h3>
            
            <div class="control-group">
                <button id="random-btn">ãƒ©ãƒ³ãƒ€ãƒ ã«ç‚¹ã‚’é…ç½®</button>
                <button id="clear-btn">ã‚¯ãƒªã‚¢</button>
                <small>ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ç‚¹ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™</small>
            </div>

            <div class="control-group">
                <label>
                    ç‚¹ã®æ•°: <span class="value-display" id="point-count">20</span>
                </label>
                <input type="range" id="point-slider" min="5" max="50" value="20" step="1">
            </div>

            <div class="control-group">
                <label>
                    è‰²ã®ãƒ¢ãƒ¼ãƒ‰:
                    <select id="color-mode">
                        <option value="distance">ä¸­å¿ƒã‹ã‚‰ã®è·é›¢</option>
                        <option value="random">ãƒ©ãƒ³ãƒ€ãƒ </option>
                        <option value="pastel">ãƒ‘ã‚¹ãƒ†ãƒ«</option>
                        <option value="giraffe">ã‚­ãƒªãƒ³é¢¨</option>
                    </select>
                </label>
            </div>

            <div class="control-group">
                <label>
                    <input type="checkbox" id="show-points" checked>
                    ç‚¹ã‚’è¡¨ç¤ºã™ã‚‹
                </label>
            </div>

            <div class="info">
                ğŸ’¡ <strong>ãƒ’ãƒ³ãƒˆ:</strong> ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦è‡ªåˆ†ã§ç‚¹ã‚’è¿½åŠ ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼
            </div>
        </div>

        <div id="canvas-container"></div>
    </div>

    <script>
        let points = [];
        let colorMode = 'distance';
        let showPoints = true;
        
        function setup() {
            let canvas = createCanvas(800, 800);
            canvas.parent('canvas-container');
            
            // åˆæœŸã®ç‚¹ã‚’é…ç½®
            generateRandomPoints(20);
            
            // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
            document.getElementById('random-btn').addEventListener('click', () => {
                const count = parseInt(document.getElementById('point-slider').value);
                generateRandomPoints(count);
                redraw();
            });
            
            document.getElementById('clear-btn').addEventListener('click', () => {
                points = [];
                redraw();
            });
            
            document.getElementById('point-slider').addEventListener('input', (e) => {
                const count = parseInt(e.target.value);
                document.getElementById('point-count').textContent = count;
            });
            
            document.getElementById('color-mode').addEventListener('change', (e) => {
                colorMode = e.target.value;
                redraw();
            });
            
            document.getElementById('show-points').addEventListener('change', (e) => {
                showPoints = e.target.checked;
                redraw();
            });
            
            noLoop();
        }
        
        function generateRandomPoints(count) {
            points = [];
            for (let i = 0; i < count; i++) {
                points.push({
                    x: random(50, width - 50),
                    y: random(50, height - 50),
                    color: color(random(255), random(255), random(255))
                });
            }
        }
        
        function mousePressed() {
            if (mouseX >= 0 && mouseX <= width && mouseY >= 0 && mouseY <= height) {
                points.push({
                    x: mouseX,
                    y: mouseY,
                    color: color(random(255), random(255), random(255))
                });
                redraw();
            }
        }
        
        function draw() {
            background(255);
            
            if (points.length === 0) {
                fill(150);
                textAlign(CENTER, CENTER);
                textSize(20);
                text('ã€Œãƒ©ãƒ³ãƒ€ãƒ ã«ç‚¹ã‚’é…ç½®ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã‹\nã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ç‚¹ã‚’è¿½åŠ ã—ã¦ãã ã•ã„', width/2, height/2);
                return;
            }
            
            // ãƒœãƒ­ãƒã‚¤å›³ã‚’æç”»ï¼ˆå„ãƒ”ã‚¯ã‚»ãƒ«ã§æœ€ã‚‚è¿‘ã„ç‚¹ã‚’æ¢ã™ï¼‰
            loadPixels();
            
            const centerX = width / 2;
            const centerY = height / 2;
            const maxDist = dist(0, 0, centerX, centerY);
            
            for (let x = 0; x < width; x++) {
                for (let y = 0; y < height; y++) {
                    let minDist = Infinity;
                    let closestPoint = null;
                    
                    // æœ€ã‚‚è¿‘ã„ç‚¹ã‚’è¦‹ã¤ã‘ã‚‹
                    for (let point of points) {
                        let d = dist(x, y, point.x, point.y);
                        if (d < minDist) {
                            minDist = d;
                            closestPoint = point;
                        }
                    }
                    
                    // è‰²ã‚’æ±ºå®š
                    let fillColor;
                    switch(colorMode) {
                        case 'distance':
                            const distFromCenter = dist(x, y, centerX, centerY);
                            const hue = map(distFromCenter, 0, maxDist, 180, 280);
                            colorMode(HSB, 360, 100, 100);
                            fillColor = color(hue, 60, 95);
                            colorMode(RGB, 255);
                            break;
                        case 'random':
                            fillColor = closestPoint.color;
                            break;
                        case 'pastel':
                            const idx = points.indexOf(closestPoint);
                            const pastelHue = (idx * 137.5) % 360;
                            colorMode(HSB, 360, 100, 100);
                            fillColor = color(pastelHue, 40, 95);
                            colorMode(RGB, 255);
                            break;
                        case 'giraffe':
                            const distToPoint = dist(x, y, closestPoint.x, closestPoint.y);
                            const brown = map(distToPoint, 0, 100, 20, 60);
                            fillColor = color(brown + random(-10, 10), brown - 10, 10);
                            break;
                    }
                    
                    set(x, y, fillColor);
                }
            }
            
            updatePixels();
            
            // ã‚»ãƒ«ã®å¢ƒç•Œç·šã‚’æãï¼ˆã‚¨ãƒƒã‚¸æ¤œå‡ºçš„ã«ï¼‰
            stroke(100, 100, 100, 100);
            strokeWeight(1);
            for (let x = 0; x < width - 1; x++) {
                for (let y = 0; y < height - 1; y++) {
                    let minDist1 = Infinity;
                    let closestPoint1 = null;
                    let minDist2 = Infinity;
                    let closestPoint2 = null;
                    
                    for (let point of points) {
                        let d1 = dist(x, y, point.x, point.y);
                        let d2 = dist(x + 1, y + 1, point.x, point.y);
                        
                        if (d1 < minDist1) {
                            minDist1 = d1;
                            closestPoint1 = point;
                        }
                        if (d2 < minDist2) {
                            minDist2 = d2;
                            closestPoint2 = point;
                        }
                    }
                    
                    if (closestPoint1 !== closestPoint2) {
                        point(x, y);
                    }
                }
            }
            
            // ç‚¹ã‚’æç”»
            if (showPoints) {
                for (let point of points) {
                    fill(50);
                    noStroke();
                    circle(point.x, point.y, 8);
                    fill(255);
                    circle(point.x, point.y, 4);
                }
            }
        }
    </script>
</body>
</html>

